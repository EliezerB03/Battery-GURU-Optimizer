window.execSafe=function(t){try{let o=ksu.exec(t);return o?.then?o.catch(()=>""):Promise.resolve(o||"")}catch{return Promise.resolve("")}};let t=(t,o)=>{let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>t(...i),o)}},o=(t,o)=>{let s;return(...i)=>{s||(t(...i),s=!0,setTimeout(()=>s=!1,o))}};window.sleep=t=>new Promise(o=>setTimeout(o,t));let s={sections:null,links:null,container:null,topFade:null,bottomFade:null,nav:null,init(){this.sections=document.querySelectorAll(".tab-section"),this.links=document.querySelectorAll(".oui-tab-link"),this.container=document.querySelector(".container"),this.topFade=document.querySelector(".top-fade"),this.bottomFade=document.querySelector(".bottom-fade"),this.nav=document.querySelector(".oui-tab")}};window.showTab=function(t,o){o.classList.contains("oui-tab-link-active")||requestAnimationFrame(()=>{s.sections.forEach(t=>t.classList.remove("active"));let i=document.getElementById(t);i&&i.classList.add("active"),initSliders(),s.links.forEach(t=>{let s=t===o;t.classList.toggle("oui-tab-link-active",s);let i=t.querySelector(".outline"),n=t.querySelector(".filled"),a=t.querySelector(".oui-tab-text"),r=t.querySelector(".oui-tab-text-active");i&&n&&a&&r&&(a.style.display=s?"none":"block",r.style.display=s?"block":"none",i.style.display=s?"none":"inline-block",n.style.display=s?"inline-block":"none")}),s.container&&(s.container.scrollTop=0)})};let i={toggle:null,sections:null},n={toggle:null,bubble:null,text:null,sections:null},a={toggle:null,bubble:null,text:null,sections:null};function r(){let{toggle:t,sections:o}=i;if(!t)return;let s=t.checked;o.forEach(t=>t.classList.toggle("disabled",!s))}function c(){let{toggle:t,bubble:o,text:s,sections:i}=n;if(!t)return;let a=t.checked;requestAnimationFrame(()=>{s.textContent=a?"ON":"OFF",s.style.color=a?"var(--accent)":"var(--text)",o.style.transition||(o.style.transition="background 0.25s ease"),o.style.background=a?"var(--toggle-master-background)":"",i.forEach(t=>{t.classList.toggle("disabled",!a),a||(t.style.pointerEvents="none",t.querySelectorAll(":active").forEach(t=>t.blur()),requestAnimationFrame(()=>{t.style.pointerEvents=""}))})})}function l(){let{toggle:t,bubble:o,text:s,sections:i}=a;if(!t)return;let n=t.checked;requestAnimationFrame(()=>{s.textContent=n?"ON":"OFF",s.style.color=n?"var(--accent)":"var(--text)",o.style.transition||(o.style.transition="background 0.25s ease"),o.style.background=n?"var(--toggle-master-background)":"",i.forEach(t=>{t.classList.toggle("disabled",!n),n||(t.style.pointerEvents="none",t.querySelectorAll(":active").forEach(t=>t.blur()),requestAnimationFrame(()=>{t.style.pointerEvents=""}))})})}let d={rafId:null,setFade(t){let o=t?"1":"0";s.topFade.style.opacity=o,s.bottomFade.style.opacity=o},isScrollable:t=>t&&t.scrollHeight>t.clientHeight+1,findScrollableForSection(t){if(!t)return null;let o=t;for(;o&&o!==document.body&&(o=o.parentElement);){if(o.classList?.contains("container"))return o;let t=getComputedStyle(o);if(/(auto|scroll)/.test(t.overflowY))return o}let i=getComputedStyle(t);return/(auto|scroll)/.test(i.overflowY)?t:s.container||document.scrollingElement||document.documentElement},update(){this.rafId&&cancelAnimationFrame(this.rafId),this.rafId=requestAnimationFrame(()=>{let t=document.querySelector("section.active");if(!t||t.hasAttribute("data-fade")&&"false"===t.getAttribute("data-fade"))return void this.setFade(!1);let o=this.findScrollableForSection(t);this.setFade(!!(o&&this.isScrollable(o)))})}};document.addEventListener("DOMContentLoaded",()=>{if(s.init(),[{cache:i,id:"batteryprotect_opt",selector:"#general .options",callback:r},{cache:n,id:"frq_on",bubbleId:"frq_toggle_master",textId:"frq_text",selector:"#freq .options",callback:c},{cache:a,id:"volt_on",bubbleId:"volt_toggle_master",textId:"volt_text",selector:"#voltage .options",callback:l}].forEach(t=>{let o=document.getElementById(t.id);o&&(t.cache.toggle=o,t.cache.sections=document.querySelectorAll(t.selector),t.bubbleId&&(t.cache.bubble=document.getElementById(t.bubbleId),t.cache.text=document.getElementById(t.textId)),o.addEventListener("change",t.callback),t.callback())}),s.topFade&&s.bottomFade){s.topFade.style.cssText="transition: opacity 200ms ease; opacity: 0",s.bottomFade.style.cssText="transition: opacity 200ms ease; opacity: 0",d.update();let i=showTab;showTab=function(t,o){i(t,o),setTimeout(()=>d.update(),40)};let n=new MutationObserver(o(()=>d.update(),100));document.querySelectorAll("section").forEach(t=>n.observe(t,{attributes:!0,attributeFilter:["class"]}));let a=new ResizeObserver(o(()=>d.update(),150));a.observe(document.documentElement),document.querySelectorAll(".container, section").forEach(t=>a.observe(t));let r=new MutationObserver(t(()=>d.update(),100));document.querySelectorAll(".container").forEach(t=>r.observe(t,{childList:!0,subtree:!0})),window.addEventListener("resize",t(()=>d.update(),150))}initSliders()}),function(){let t=s.container||document.querySelector(".container");if(!t)return;let i=t.querySelector(".container-scrollbar"),n=i?.querySelector(".container-scrollbar-thumb");if(!i||!n)return;let a,r=null;function c(){r=null;let o=t.scrollHeight,s=t.clientHeight;if(o<=s+1){i.style.display="none";return}i.style.display="block";let a=i.clientHeight,c=Math.max(s/o*a,24),l=a-c,d=Math.min(l,Math.max(0,t.scrollTop/(o-s||1)*l));n.style.height=c+"px",n.style.transform=`translateY(${d}px)`}function l(){r||(r=requestAnimationFrame(c))}let d=o(()=>{t.classList.add("show-scrollbar"),clearTimeout(a),a=setTimeout(()=>t.classList.remove("show-scrollbar"),1500)},50);t.addEventListener("scroll",()=>{l(),d()},{passive:!0}),window.addEventListener("resize",()=>l());let u=window.showTab;u&&(window.showTab=function(o,s){u(o,s),requestAnimationFrame(()=>{l(),t.classList.remove("show-scrollbar")})}),requestAnimationFrame(c)}();let u=document.querySelector(".container"),p=document.querySelectorAll(".tab-section"),m=new Map;p.forEach(t=>{let o=t.querySelector(".oui-viewing"),s=t.querySelector(".oui-header"),i=t.querySelector(".info-header");o&&s&&m.set(t,{viewing:o,header:s,infoviewing:i,compact:!1,infoCompact:!1})});let _=null,v=null;function h(t=!1){m.forEach(o=>{let{viewing:s,header:i,infoviewing:n}=o,a=s.getBoundingClientRect(),r=Math.max(0,Math.min(-a.top/a.height,1)),c=r>1e-4,l=r>.6;(t||o.compact!==c)&&(o.compact=c,i.classList.toggle("header-compact",c),s.classList.toggle("header-compact",c)),(t||o.infoCompact!==l)&&(o.infoCompact=l,i.classList.toggle("header-compact-infobtn",l),n?.classList.toggle("header-compact-infobtn",l))})}function f(t={}){let{effectClass:o="toggle-effect",roundedLogic:s=null,deltaThreshold:i=8,useDeltaY:n=!0,cooldown:a=300,onClickHandler:r=null}=t;return function(t){let c={pointerDown:!1,pointerInside:!1,cancelled:!1,moved:!1,animationTimeout:null,inactivityTimeout:null,startPos:0,lastActionTime:0},l=t.querySelector(".oui-inner")||t.closest(".oui-button, .oui-button-active, .oui-tab-inner")||t,d=()=>{clearTimeout(c.animationTimeout),clearTimeout(c.inactivityTimeout);let s=t.querySelector(`.${o}`);s&&(s.classList.remove("animate-in"),s.classList.add("animate-out"),l.classList.remove("pressed-effect"),l.classList.add("released-effect"),c.animationTimeout=setTimeout(()=>{l.classList.remove("released-effect"),s.remove()},550))},u=s=>{if(!c.pointerDown)return;clearTimeout(c.inactivityTimeout),c.inactivityTimeout=setTimeout(()=>{c.pointerDown&&!c.moved&&(c.cancelled=!0,d(),c.pointerInside=!1)},700);let a=Math.abs((s.touches?n?s.touches[0].clientY:s.touches[0].clientX:n?s.clientY:s.clientX)-c.startPos);if(!c.moved&&a>i){c.cancelled=!0,c.moved=!0,d(),c.pointerInside=!1,l.classList.remove("pressed-effect");return}if("button-effect"===o){let o=t.getBoundingClientRect(),i=s.touches?s.touches[0].clientX:s.clientX,n=s.touches?s.touches[0].clientY:s.clientY;(i<o.left||i>o.right||n<o.top||n>o.bottom)&&c.pointerInside&&(c.cancelled=!0,d(),c.pointerInside=!1,l.classList.remove("pressed-effect"))}},p=()=>{if(!c.pointerDown)return;c.pointerDown=!1,document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",p),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",p);let o=Date.now();c.pointerInside&&!c.cancelled&&!c.moved&&o-c.lastActionTime>=a&&(c.lastActionTime=o,r?r(t):t.click()),d(),c.pointerInside=!1,c.cancelled=!1,c.moved=!1},m=i=>{Date.now()-c.lastActionTime<a?i.preventDefault():(c.pointerDown=!0,c.pointerInside=!0,c.cancelled=!1,c.moved=!1,c.startPos=i.touches?n?i.touches[0].clientY:i.touches[0].clientX:n?i.clientY:i.clientX,clearTimeout(c.animationTimeout),clearTimeout(c.inactivityTimeout),c.inactivityTimeout=setTimeout(()=>{c.pointerDown&&!c.moved&&(c.cancelled=!0,d(),c.pointerInside=!1)},700),l.classList.remove("released-effect"),l.classList.add("pressed-effect"),(()=>{if(c.cancelled)return;t.querySelector(`.${o}`)?.remove();let i=document.createElement("span");i.className=`${o} animate-in`,s&&s(t,i),t.appendChild(i),l.classList.add("pressed-effect")})(),document.addEventListener("pointermove",u,{passive:!0}),document.addEventListener("pointerup",p,{passive:!0}),document.addEventListener("touchmove",u,{passive:!0}),document.addEventListener("touchend",p,{passive:!0}))};t.addEventListener("click",t=>{c.pointerInside||(t.preventDefault(),t.stopPropagation())},!0),t.addEventListener("touchstart",m,{passive:!1}),t.addEventListener("pointerdown",m,{passive:!1})}}u.addEventListener("scroll",()=>{_||(_=requestAnimationFrame(()=>{h(!1),_=null})),clearTimeout(v),v=setTimeout(()=>h(!0),80)},{passive:!0}),h(!0);let y=f({effectClass:"toggle-effect",roundedLogic:(t,o)=>{if(null!==t.querySelector("#batteryprotect_opt"))o.classList.add("rounded-top");else{let s=[...t.parentElement.querySelectorAll(".oui-container-toggle, .oui-bubble-item, .oui-bubble-item2")],i=t===s[0],n=t===s[s.length-1];1===s.length?o.classList.add("rounded-all"):i?o.classList.add("rounded-top"):n&&o.classList.add("rounded-bottom")}},deltaThreshold:8,useDeltaY:!0,cooldown:300});document.querySelectorAll(".oui-container-toggle, .oui-bubble-item, .oui-bubble-item2").forEach(y);let g=f({effectClass:"button-effect",deltaThreshold:8,useDeltaY:!0,cooldown:300});document.querySelectorAll(".oui-button, .oui-button-active").forEach(g);let b=f({effectClass:"tab-button-effect",roundedLogic:(t,o)=>o.classList.add("rounded-all"),deltaThreshold:8,useDeltaY:!1,cooldown:300});document.querySelectorAll(".oui-tab-link").forEach(b);let w=f({effectClass:"dialog-button-effect",roundedLogic:(t,o)=>o.classList.add("rounded-all"),deltaThreshold:8,useDeltaY:!0,cooldown:0});function E(){_||(_=requestAnimationFrame(()=>{_=null;let t=window.__popupInstance,o=window.__popupPositioner,s=window.__getActiveTrigger?.();t&&o&&t.classList.contains("show")&&s&&o(s)}))}async function L(){try{let t=await execSafe("pm list packages | grep com.guru.batteryoptimizer");return t&&t.toString().trim().includes("com.guru.batteryoptimizer")}catch{return!1}}document.querySelectorAll(".oui-dialog-action-button").forEach(w),document.querySelectorAll(".oui-overlay-bubble-info, .oui-overlay-bubble-info-header").forEach(t=>{let o={pointerDown:!1,pointerInside:!1,cancelled:!1,moved:!1,animationTimeout:null,inactivityTimeout:null,startY:0,dialogOpened:!1},s=()=>{clearTimeout(o.animationTimeout),clearTimeout(o.inactivityTimeout);let s=t.querySelector(".oui-icon-info-effect");s&&(s.classList.remove("animate-in"),s.classList.add("animate-out"),t.classList.remove("pressed-effect"),t.classList.add("released-effect"),o.animationTimeout=setTimeout(()=>{t.classList.remove("released-effect"),s.remove()},550))},i=i=>{if(!o.pointerDown)return;clearTimeout(o.inactivityTimeout),o.inactivityTimeout=setTimeout(()=>{o.pointerDown&&!o.moved&&(o.cancelled=!0,s(),o.pointerInside=!1)},700);let n=Math.abs((i.touches?i.touches[0].clientY:i.clientY)-o.startY);!o.moved&&n>8&&(o.cancelled=!0,o.moved=!0,s(),o.pointerInside=!1,t.classList.remove("pressed-effect"))},n=()=>{o.pointerDown&&(o.pointerDown=!1,document.removeEventListener("pointermove",i),document.removeEventListener("pointerup",n),document.removeEventListener("touchmove",i),document.removeEventListener("touchend",n),!o.pointerInside||o.cancelled||o.moved||o.dialogOpened||(o.dialogOpened=!0,t.click(),setTimeout(()=>o.dialogOpened=!1,50)),s(),o.pointerInside=!1,o.cancelled=!1,o.moved=!1)},a=a=>{o.pointerDown=!0,o.pointerInside=!0,o.cancelled=!1,o.moved=!1,o.startY=a.touches?a.touches[0].clientY:a.clientY,clearTimeout(o.animationTimeout),clearTimeout(o.inactivityTimeout),o.inactivityTimeout=setTimeout(()=>{o.pointerDown&&!o.moved&&(o.cancelled=!0,s(),o.pointerInside=!1)},700),t.classList.remove("released-effect"),t.classList.add("pressed-effect"),(()=>{if(o.cancelled)return;t.querySelector(".oui-icon-info-effect")?.remove();let s=document.createElement("span");s.className="oui-icon-info-effect animate-in rounded-all",t.appendChild(s),t.classList.add("pressed-effect"),t.classList.remove("released-effect")})(),document.addEventListener("pointermove",i,{passive:!0}),document.addEventListener("pointerup",n,{passive:!0}),document.addEventListener("touchmove",i,{passive:!0}),document.addEventListener("touchend",n,{passive:!0})};t.addEventListener("click",t=>{o.pointerInside||(t.preventDefault(),t.stopPropagation())},!0),t.addEventListener("touchstart",a,{passive:!1}),t.addEventListener("pointerdown",a,{passive:!1})}),document.querySelector(".container").addEventListener("scroll",E,{passive:!0}),window.addEventListener("resize",E),function(){let t=null,o=document.getElementById("popup-menu");if(o&&o.parentElement!==document.body&&document.body.appendChild(o),window.__popupInstance=o,window.__popupPositioner=f,window.__getActiveTrigger=()=>t,!o)return;let s={content:o.querySelector(".popup-content"),optionsList:document.getElementById("popup-options")},i={popupOpen:!1,optionsEnabled:!0,pointerDownOutside:!1},n=0,a=document.querySelector(".container"),r=o.querySelector(".popup-scrollbar"),c=o.querySelector(".popup-scrollbar-thumb"),l=null,d=()=>{c.classList.add("show"),clearTimeout(l),l=setTimeout(u,1500)},u=()=>c.classList.remove("show");function p(){let t=s.optionsList;if(t.scrollHeight<=t.clientHeight){r.style.display="none";return}r.style.display="block";let o=t.clientHeight/t.scrollHeight,i=Math.max(18,t.clientHeight*o),n=t.scrollTop/(t.scrollHeight-t.clientHeight),a=r.clientHeight-i;c.style.height=i+"px",c.style.top=a*n+"px"}s.optionsList.addEventListener("scroll",()=>{p(),v(),d()}),window.addEventListener("resize",p);let m=o.querySelector(".popup-fade-top"),_=o.querySelector(".popup-fade-bottom");function v(){let t=s.optionsList;if(!(t.scrollHeight>t.clientHeight+1)){m.classList.remove("show"),_.classList.remove("show");return}let o=t.scrollTop<=3,i=t.scrollTop+t.clientHeight>=t.scrollHeight-2;m.classList.toggle("show",!o),_.classList.toggle("show",!i)}function h(){o.classList.remove("show"),i.popupOpen=!1,i.optionsEnabled=!0,t=null,a&&(a.style.overflow="auto",a.scrollTop=n),document.querySelectorAll(".popup-label-active").forEach(t=>t.classList.remove("popup-label-active")),c.classList.remove("show"),clearTimeout(l)}function f(t){let s,i=t.getBoundingClientRect(),n=o.offsetHeight,a=o.offsetWidth,r=window.innerHeight,c=window.innerWidth,l=.025*c,d=i.right+8;d+a>c-l&&(d=c-a-l);let u=r-i.bottom,p=i.top;u>=n?(s=i.top)+n>r-.15*r&&p>=n&&(s=i.bottom-n):p>=n?(s=i.bottom-n)<.2*r&&u>=n&&(s=i.top):s=u>p?i.top:i.bottom-n,o.style.top=s+"px",o.style.left=d+"px"}function y(t,o,n,a){s.optionsList.innerHTML="",t.forEach((r,c)=>{let l,d,u,p,m,_=document.createElement("li");_.className="oui-bubble-item";let v="";if(1===t.length?v="rounded-all":0===c?v="rounded-top":c===t.length-1&&(v="rounded-bottom"),_.innerHTML=`
        <div class="popup-inner">
          <span class="popup-text">${r}</span>
        </div>
        <span class="popup-effect ${v}"></span>
      `,r===o){_.classList.add("selected");let t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("class","popup-icon-selected checkmark"),t.innerHTML='<path style="fill:none;stroke:currentColor;stroke-linecap:round;stroke-linejoin:round;stroke-width:3" d="m5 12 5 5 9-9"/>',_.querySelector(".popup-inner").appendChild(t)}let f=_.querySelector(".popup-inner"),y=_.querySelector(".popup-effect");l={down:!1,inside:!1,cancelled:!1,moved:!1,animTimeout:null,inactTimeout:null,startY:0,lastTime:0},d=()=>{clearTimeout(l.animTimeout),clearTimeout(l.inactTimeout),y.classList.contains("animate-in")&&(y.classList.remove("animate-in"),y.classList.add("animate-out"),f.classList.remove("pressed-effect"),f.classList.add("released-effect"),l.animTimeout=setTimeout(()=>{y.classList.remove("animate-out"),f.classList.remove("released-effect")},550))},u=t=>{if(!l.down)return;clearTimeout(l.inactTimeout),l.inactTimeout=setTimeout(()=>{l.down&&!l.moved&&(l.cancelled=!0,d(),l.inside=!1)},700);let o=Math.abs((t.touches?t.touches[0].clientY:t.clientY)-l.startY);if(!l.moved&&o>8){l.cancelled=!0,l.moved=!0,d(),l.inside=!1,f.classList.remove("pressed-effect");return}let s=_.getBoundingClientRect(),i=t.touches?t.touches[0].clientX:t.clientX,n=t.touches?t.touches[0].clientY:t.clientY;(i<s.left||i>s.right||n<s.top||n>s.bottom)&&l.inside&&(l.cancelled=!0,d(),l.inside=!1,f.classList.remove("pressed-effect"))},p=()=>{if(!l.down)return;l.down=!1,document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",p),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",p);let t=Date.now();l.inside&&!l.cancelled&&!l.moved&&t-l.lastTime>=200&&(l.lastTime=t,i.optionsEnabled&&a&&(h(),a(r,n))),d(),l.inside=!1,l.cancelled=!1,l.moved=!1},m=t=>{if(!i.optionsEnabled){t.preventDefault(),t.stopPropagation();return}Date.now()-l.lastTime<200?t.preventDefault():(l.down=!0,l.inside=!0,l.cancelled=!1,l.moved=!1,l.startY=t.touches?t.touches[0].clientY:t.clientY,clearTimeout(l.animTimeout),clearTimeout(l.inactTimeout),l.inactTimeout=setTimeout(()=>{l.down&&!l.moved&&(l.cancelled=!0,d(),l.inside=!1)},700),f.classList.remove("released-effect"),l.cancelled||(y.classList.remove("animate-out"),y.classList.add("animate-in"),f.classList.add("pressed-effect"),f.classList.remove("released-effect")),document.addEventListener("pointermove",u,{passive:!0}),document.addEventListener("pointerup",p,{passive:!0}),document.addEventListener("touchmove",u,{passive:!0}),document.addEventListener("touchend",p,{passive:!0}))},_.addEventListener("click",t=>{l.inside||(t.preventDefault(),t.stopPropagation())},!0),_.addEventListener("touchstart",m,{passive:!1}),_.addEventListener("pointerdown",m,{passive:!1}),s.optionsList.appendChild(_)}),requestAnimationFrame(()=>{!function(){let t=s.optionsList.children;if(!t.length)return;let o=t[0].offsetHeight;t.length>4.55?(s.optionsList.style.maxHeight=4.55*o+"px",s.optionsList.style.overflowY="scroll"):(s.optionsList.style.maxHeight="none",s.optionsList.style.overflowY="hidden")}(),p(),v()})}document.addEventListener("pointerdown",t=>{i.pointerDownOutside=!o.contains(t.target)},!0),document.addEventListener("pointerup",t=>{i.popupOpen&&i.pointerDownOutside&&!o.contains(t.target)&&(h(),t.preventDefault(),t.stopPropagation())},!0),["click","pointerdown","pointerup","touchstart","touchend"].forEach(t=>{document.addEventListener(t,t=>{i.popupOpen&&!o.contains(t.target)&&(t.preventDefault(),t.stopPropagation())},{capture:!0,passive:!1})});window.initPopup={openPopup:function(r,c){t=r;let l=JSON.parse(r.dataset.options),u=r.dataset.selected;o.classList.contains("show")?(f(r),setTimeout(()=>{y(l,u,r,c),s.optionsList.scrollTop=0,p(),v()},150)):(y(l,u,r,c),requestAnimationFrame(()=>{s.optionsList.scrollTop=0,o.classList.add("show"),i.popupOpen=!0,a&&(n=a.scrollTop,a.style.overflow="hidden"),requestAnimationFrame(()=>{f(r),p(),function(){let o=s.optionsList,i=t?.dataset?.selected;if(!i){o.scrollTop=0,p();return}let n=o.querySelectorAll("li"),a=null;if(n.forEach(t=>{t.textContent.trim()===i.trim()&&(a=t)}),!a){o.scrollTop=0,p();return}let r=a.offsetTop,c=a.offsetHeight,l=o.clientHeight;o.scrollTop=Math.max(0,r-l/3.169+c/2),p(),v(),d()}(),v(),d()})}))},closePopup:h,disableOptionsTemporarily:(t=300)=>{i.optionsEnabled=!1,setTimeout(()=>i.optionsEnabled=!0,t)}}}(),window.initSliders=function(){let t,o,s=["big_volt","lit_volt","g3d_volt","mif_volt","aud_volt","cam_volt","cp_volt","disp_volt","fsys0_volt","int_volt","intcam_volt","iva_volt","score_volt"],i=["batt_level"],n=new Map,a=new Map,r=new Map,c=null,l=new Map,d=null;function u(t){if(!l.has(t)){let o=document.getElementById(t);if(!o)return null;l.set(t,{slider:o,parent:o.parentElement,dotsContainer:o.nextElementSibling,valuesContainer:o.parentElement.querySelector(".slider-values, .batt-slider-values")})}return l.get(t)}function p(t){t.forEach(t=>{let o=u(t);if(!o?.slider||!o.dotsContainer)return;let s=o.slider.max-o.slider.min,i=o.slider.offsetLeft-o.dotsContainer.offsetLeft,n=o.slider.offsetWidth-20,a=document.createDocumentFragment();for(let t=0;t<=s;t++){let o=document.createElement("span");o.style.left=`${i+10+t/s*n}px`,a.appendChild(o)}o.dotsContainer.innerHTML="",o.dotsContainer.appendChild(a)})}function m(t){let o=u(t);if(!o?.slider||!o.valuesContainer)return;let s=o.slider.offsetLeft-o.valuesContainer.offsetLeft,i=o.slider.offsetWidth-20,n=o.valuesContainer.querySelectorAll("span");if(3!==n.length)return;let a=[s+10,s+10+.5*i,s+10+i];n.forEach((t,o)=>{t.style.cssText=`position: absolute; top: 0; transform: translateX(-50%); left: ${a[o]}px`})}let _=(t,o)=>{let s=t.get(o);s&&(clearTimeout(s),t.delete(o))},v=(t,o,s,i)=>{_(t,o),t.set(o,setTimeout(s,i))};function h(t,o=!1){let s=o?"batt-slider-value-float":"slider-value-float",i=u(t.id),n=i.parent.querySelector(`.${s}`);n||((n=document.createElement("div")).className=s,n.innerHTML=`<span class="${o?"slider-bat-value-text":"slider-value-text"}"></span>`,i.parent.appendChild(n));let a=n.firstElementChild,r=t.valueAsNumber;a.textContent=o?`${80+r}%`:0===r?"0":`-${r}`,n.style.width="",n.style.height="";let c=Math.max(o?45:37,a.scrollWidth+12,a.scrollHeight+12);n.style.width=`${c}px`,n.style.height=`${c}px`,n.style.transform=`translateX(-${c/2-10}px)`;let l=t.offsetWidth-20,d=(r-t.min)/(t.max-t.min);n.style.left=`${10+l*d}px`}function f(t,o,s=!1){let i=u(t.id).parent.querySelector(`.${s?"batt-slider-value-float":"slider-value-float"}`);i?.classList.toggle("visible",o)}let y=null;function g(t,o=null){c||(c=document.querySelectorAll("button, .oui-container-toggle, .popup-trigger, .oui-tab-link, .oui-overlay-bubble-info")),y&&(clearTimeout(y),y=null);let n=t?"":"none";c.forEach(t=>t.style.pointerEvents=n),[...s,...i].forEach(t=>{let s=u(t);s?.slider&&s.slider!==o&&(s.slider.style.pointerEvents=n)}),d=t?null:o}function b(t,o=20){y&&clearTimeout(y),y=setTimeout(()=>{g(t),y=null},o)}function w(t,o=!1){let r=o?t=>_(a,t):t=>_(n,t),c=o?(t,o,s)=>v(a,t,o,s):(t,o,s)=>v(n,t,o,s);if(t.forEach(t=>{let s=u(t);if(!s?.slider)return;let i=s.slider;h(i,o);let n=()=>{b(!0,20),c(t,()=>f(i,!1,o),270)};i.addEventListener("pointerdown",()=>{r(t),g(!1,i),h(i,o),f(i,!0,o)},{passive:!1}),i.addEventListener("pointerup",n,{passive:!1}),i.addEventListener("pointercancel",n),i.addEventListener("lostpointercapture",n),i.addEventListener("input",()=>h(i,o),{passive:!0})}),!window._sliderGlobalListenersAdded){if(!window._sliderFailsafeAdded){let t=()=>{d||(g(!0),[...s,...i].forEach(t=>{let o=u(t)?.slider;o&&o.classList.remove("active-thumb")}))};window.addEventListener("blur",t),window.addEventListener("visibilitychange",()=>{document.hidden&&t()}),window._sliderFailsafeAdded=!0}window.addEventListener("mouseup",()=>{d&&d.contains(e.target)||(b(!0,20),[...s,...i].forEach(t=>{let o=u(t);if(o?.slider){let s=i.includes(t);(s?(t,o,s)=>v(a,t,o,s):(t,o,s)=>v(n,t,o,s))(t,()=>f(o.slider,!1,s),270)}}))},{passive:!0}),window._sliderGlobalListenersAdded=!0}}function E(t,o=!1){let s=o?t=>_(a,t):t=>_(n,t),i=o?(t,o,s)=>v(a,t,o,s):(t,o,s)=>v(n,t,o,s);t.forEach(t=>{let n=u(t);if(!n?.slider)return;let a=n.slider,c={down:!1,startX:0,startValue:0,moved:!1,initialValue:0,shouldFire:!1,rafId:null,hasDragged:!1};a.addEventListener("pointerdown",i=>{let n=Date.now();if(n-(r.get(t)||0)<100)return void i.preventDefault();r.set(t,n),s(t),c.down=!0,c.moved=!1,c.hasDragged=!1,c.shouldFire=!1,c.initialValue=a.valueAsNumber;let l=a.getBoundingClientRect(),d=i.clientX-l.left,u=Number(a.min)||0,p=Number(a.max)||100,m=p-u,_=u+d/l.width*m;a.value=Math.round(Math.min(p,Math.max(u,_))),h(a,o),a.valueAsNumber!==c.initialValue&&(c.shouldFire=!0),c.startX=i.clientX,c.startValue=a.valueAsNumber;try{a.setPointerCapture(i.pointerId)}catch{}f(a,!0,o),a.classList.add("active-thumb"),i.preventDefault()},{passive:!1}),a.addEventListener("pointermove",t=>{if(!c.down)return;t.preventDefault();let s=t.clientX-c.startX;Math.abs(s)>5&&(c.moved=!0,c.hasDragged=!0),c.rafId&&cancelAnimationFrame(c.rafId),c.rafId=requestAnimationFrame(()=>{let t=a.clientWidth,i=Number(a.min)||0,n=Number(a.max)||100,r=c.startValue+s/t*(n-i);a.value=Math.round(r=Math.min(n,Math.max(i,r))),h(a,o),c.shouldFire=!0})},{passive:!1}),a.addEventListener("pointerup",s=>{c.down&&(c.down=!1,c.rafId&&(cancelAnimationFrame(c.rafId),c.rafId=null),a.releasePointerCapture(s.pointerId),c.shouldFire&&a.valueAsNumber!==c.initialValue&&a.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),b(!0,20),i(t,()=>f(a,!1,o),280),a.classList.remove("active-thumb"))},{passive:!1}),a.addEventListener("pointercancel",s=>{c.down=!1,c.rafId&&(cancelAnimationFrame(c.rafId),c.rafId=null),a.releasePointerCapture(s.pointerId),b(!0,20),i(t,()=>f(a,!1,o),280),a.classList.remove("active-thumb")})})}p([...s,...i]),[...s,...i].forEach(t=>m(t)),w(s,!1),w(i,!0),E(s,!1),E(i,!0),window.addEventListener("resize",()=>{o&&cancelAnimationFrame(o),clearTimeout(t),o=requestAnimationFrame(()=>{[...s,...i].forEach(t=>{let o=u(t);o?.slider&&h(o.slider,i.includes(t))})}),t=setTimeout(()=>{p([...s,...i]),[...s,...i].forEach(t=>m(t))},150)},{passive:!0})},document.addEventListener("DOMContentLoaded",()=>{let t=(t,o)=>{let s;return(...i)=>{s||(t(...i),s=!0,setTimeout(()=>s=!1,o))}},o={mask:document.querySelector(".oui-dialog-mask"),body:document.body,doc:document.documentElement,buttons:null,dialogs:document.querySelectorAll(".oui-dialog")},s=null,i=!1,n=0,a=new WeakMap,r=new WeakMap,c=t=>{let o=t.target;for(;o;){let t=window.getComputedStyle(o);if("auto"===t.overflowY||"scroll"===t.overflowY||o.classList?.contains("oui-dialog-description"))return;if(o=o.parentElement,o?.classList?.contains("oui-dialog"))break}t.preventDefault()},l=t=>n=t.touches[0].clientY,d=t=>{if(!s)return;let o=t.target,i=!1;for(;o&&o!==s;){let t=window.getComputedStyle(o);if(("auto"===t.overflowY||"scroll"===t.overflowY)&&o.scrollHeight>o.clientHeight){i=!0;break}o=o.parentElement}if(i)return;let{scrollTop:a,scrollHeight:r,offsetHeight:c}=s,l=t.touches[0].clientY,d=l>n,u=l<n;(0===a&&d||a+c>=r&&u)&&t.preventDefault(),n=l},u=t=>{i=!t,requestAnimationFrame(()=>{o.buttons||(o.buttons=document.querySelectorAll(".oui-dialog-action-button, .close-dialog-btn, .reset-dialog-btn")),o.buttons.forEach(o=>o.style.pointerEvents=t?"":"none"),t?(o.body.classList.remove("app-blocked-body"),o.doc.classList.remove("app-blocked")):(o.body.classList.add("app-blocked-body"),o.doc.classList.add("app-blocked"))})},p=t=>{let o=document.getElementById("resetting_app_dialog");if(i||o?.classList.contains("show"))return t.preventDefault(),t.stopPropagation(),!1;_()},m=(t,i={mask:!0,maskType:"default"})=>{u(!1),t.querySelectorAll('.oui-dialog-description, [style*="overflow-y: auto"], [style*="overflow-y: scroll"]').forEach(t=>t.scrollTop=0),t.classList.add("show"),i.mask&&("warn"!==i.maskType&&o.mask.addEventListener("click",p,{passive:!1}),o.mask.classList.add("show")),s=t,o.body.classList.add("no-scroll");let n=b(t);n?.reset(),n?.show(),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchstart",l,{passive:!1}),document.addEventListener("touchmove",d,{passive:!1}),setTimeout(()=>u(!0),275)},_=()=>{if(!s)return;u(!1),s.classList.remove("show"),s.classList.add("hide"),o.mask.classList.contains("show")&&(o.mask.classList.remove("show"),o.mask.removeEventListener("click",p)),o.body.classList.remove("no-scroll"),document.removeEventListener("touchmove",c),document.removeEventListener("touchstart",l),document.removeEventListener("touchmove",d);let t=o=>{o.target===s&&s.classList.contains("hide")&&(s.removeEventListener("transitionend",t),setTimeout(()=>{s.classList.remove("hide"),s=null,u(!0)},10))};s.addEventListener("transitionend",t)};window.openDialog=m,window.closeDialog=_;let v=(o,s)=>{let i=a.get(o)||(o=>{if(!o)return null;if(a.has(o))return a.get(o);let s=o.querySelector(".oui-dialog-description");if(!s)return null;let i=o.querySelector(".dialog-top-fade"),n=o.querySelector(".dialog-bottom-fade");i||((i=document.createElement("div")).className="dialog-top-fade",i.style.opacity="0",o.appendChild(i)),n||((n=document.createElement("div")).className="dialog-bottom-fade",n.style.opacity="0",o.appendChild(n));let r=t(()=>{requestAnimationFrame(()=>{let t=s.getBoundingClientRect(),a=o.getBoundingClientRect();i.style.top=`${t.top-a.top}px`,n.style.bottom=`${a.bottom-t.bottom}px`})},100);if(r(),"ResizeObserver"in window){let t=new ResizeObserver(r);t.observe(s),t.observe(o)}let c={desc:s,top:i,bottom:n};return a.set(o,c),c})(o);if(!i)return;let n=s?"1":"0";i.top.style.opacity=n,i.bottom.style.opacity=n},h=null,f=()=>{h&&cancelAnimationFrame(h),h=requestAnimationFrame(()=>{let t=document.querySelector(".oui-dialog.show");if(!t)return v(t,!1);let o=t.querySelector(".oui-dialog-description")||t;v(t,o?.scrollHeight>o?.clientHeight+1)})};document.querySelectorAll("[data-dialog-target]").forEach(t=>{t.addEventListener("click",o=>{if(i)return o.preventDefault(),o.stopPropagation(),!1;let s=t.getAttribute("data-dialog-target"),n=document.getElementById(s),a=t.querySelector('input[type="checkbox"].toggle');n?.querySelector(".oui-loading")&&window.resetLoadingAnimation&&window.resetLoadingAnimation(n.querySelector(".oui-loading")),a?setTimeout(()=>a.checked&&n&&m(n),0):n&&m(n)})}),document.querySelectorAll(".close-dialog-btn").forEach(t=>{t.addEventListener("click",t=>{if(i)return t.preventDefault(),t.stopPropagation(),!1;_()})}),f();let y=new MutationObserver(t(f,100));if(o.dialogs.forEach(t=>y.observe(t,{attributes:!0,attributeFilter:["class"]})),"ResizeObserver"in window){let s=new ResizeObserver(t(f,150));s.observe(o.doc),document.querySelectorAll(".oui-dialog, .oui-dialog-description").forEach(t=>s.observe(t))}let g=new MutationObserver(t(f,100));document.querySelectorAll(".oui-dialog .oui-dialog-description").forEach(t=>g.observe(t,{childList:!0,subtree:!0})),window.addEventListener("resize",t(f,150));let b=t=>{if(!t)return null;if(r.has(t))return r.get(t);let o=t.querySelector(".oui-dialog-description"),s=t.querySelector(".dialog-scrollbar"),i=t.querySelector(".dialog-scrollbar-thumb");if(!o||!s||!i)return null;let n=null,a=!1,c=()=>{a=!1;let t=o.scrollHeight,n=o.clientHeight;if(t<=n+1)return void s.classList.remove("show");let r=o.scrollTop,c=s.clientHeight,l=Math.max(n/t*c,24);i.style.height=l+"px",i.style.transform=`translateY(${r/(t-n)*(c-l)}px)`},l=()=>{a||(a=!0,requestAnimationFrame(c))};if(o.addEventListener("scroll",()=>{l(),s.classList.add("show"),clearTimeout(n),n=setTimeout(()=>s.classList.remove("show"),1500)},{passive:!0}),"ResizeObserver"in window){let s=new ResizeObserver(()=>l());s.observe(o),s.observe(t)}let d={reset(){o.scrollTop=0,s.classList.remove("show"),l()},show(){s.classList.add("show"),clearTimeout(n),n=setTimeout(()=>s.classList.remove("show"),1500)}};return r.set(t,d),l(),d}}),async function(){if(await L())return;let t="/data/adb/modules/battery-guru-optimizer-9810/boot-completed.sh",o=`# BATTERY GURU OPTIMIZER (ALL SETTINGS)
# Developed by @EliezerB03

#!/system/bin/sh

# changelog=1
# ============== ALL OPTIMIZATIONS  ============== #

#---------------< BATTERY OPTIMIZATIONS ON APPS >---------------#
# forceappsbattopt_on=1
settings put global forced_app_standby_enabled 1

#---------------< CPU HOTPLUG OPTIMIZATIONS >---------------#
# hotplugset_on=1
echo '0' > /sys/power/cpuhotplug/governor/user_mode
echo '0' > /sys/power/cpuhotplug/governor/enabled

#---------------< CPU POWER EFFICIENT >---------------#
# powereffiset_on=1
echo 'Y' > /sys/module/workqueue/parameters/power_efficient

#---------------< THERMAL OPTIMIZATIONS >---------------#
# thermalset_on=1
system_table_set activity_manager_constants max_cached_processes=0,background_settle_time=0,fgservice_min_shown_time=0,fgservice_min_report_time=0,fgservice_screen_on_before_time=0,fgservice_screen_on_after_time=0,content_provider_retain_time=0,gc_timeout=0,gc_min_interval=0,full_pss_min_interval=0,full_pss_lowered_interval=0,power_check_interval=0,power_check_max_cpu_1=0,power_check_max_cpu_2=0,power_check_max_cpu_3=0,power_check_max_cpu_4=0,service_usage_interaction_time=0,usage_stats_interaction_interval=0,service_restart_duration=0,service_reset_run_duration=0,service_restart_duration_factor=0,service_min_restart_time_between=0,service_max_inactivity=0,service_bg_start_timeout=0,CUR_MAX_CACHED_PROCESSES=0,CUR_MAX_EMPTY_PROCESSES=0,CUR_TRIM_EMPTY_PROCESSES=0,CUR_TRIM_CACHED_PROCESSES=0
chmod 666 /sys/devices/system/cpu/cpu[0-7]/max_cpus; chmod 666 /sys/devices/system/cpu/cpu[0-7]/min_cpus
echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/max_cpus; echo 0 > /sys/devices/system/cpu/cpu4/core_ctl/min_cpus; echo 60 > /sys/devices/system/cpu/cpu4/core_ctl/busy_down_thres
echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/task_thres; echo 80 > /sys/devices/system/cpu/cpu4/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu4/core_ctl/offline_delay_ms
echo 2 > /sys/devices/system/cpu/cpu0/core_ctl/min_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/max_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/task_thres
echo 80 > /sys/devices/system/cpu/cpu0/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu0/core_ctl/offline_delay_ms; echo 60 > /sys/devices/system/cpu/cpu0/core_ctl/busy_down_thres
chmod 444 /sys/devices/system/cpu/cpu[0-7]/max_cpus
pm disable com.google.android.gms/.chimera.GmsIntentOperationService

#---------------< GPU BOOST >---------------#
# gpuboost_on=0
echo '1' > /sys/devices/platform/17500000.mali/dvfs_governor

#---------------< SWAP OPTIMIZATIONS >---------------#
# swapset_on=1
echo '10' > /proc/sys/vm/dirty_ratio
echo '3' > /proc/sys/vm/dirty_background_ratio
echo '2500' > /proc/sys/vm/dirty_expire_centisecs
echo '1250' > /proc/sys/vm/dirty_writeback_centisecs
echo '2' > /proc/sys/vm/laptop_mode
echo '70' > /proc/sys/vm/swappiness

#---------------< STORAGE OPTIMIZATIONS >---------------#
# storageset_on=1
echo '1' > /sys/block/sda/queue/rotational
echo '1' > /sys/block/sda/queue/add_random
echo '2' > /sys/block/sda/queue/rq_affinity

#---------------< BATTERY PROTECTION >---------------#
# batteryprotect_on=0
# battery_litmit=90%
echo '100' > /sys/class/power_supply/battery/batt_full_capacity

#---------------< FREQS SETTINGS >---------------#
# frqset_on=1
# lit=1690
echo '1690000' > /sys/devices/system/cpu/cpufreq/policy0/scaling_max_freq
# big=1690
echo '1690000' > /sys/devices/system/cpu/cpufreq/policy4/scaling_max_freq

#---------------< VOLTAGE SETTINGS >---------------#
# voltset_on=1
# big_volt=-4
echo '-4' > /sys/power/percent_margin/big_margin_percent
# lit_volt=-4
echo '-4' > /sys/power/percent_margin/lit_margin_percent
# g3d_volt=-4
echo '-4' > /sys/power/percent_margin/g3d_margin_percent
# mif_volt=-4
echo '-4' > /sys/power/percent_margin/mif_margin_percent
# aud_volt=-4
echo '-4' > /sys/power/percent_margin/aud_margin_percent
# cam_volt=-4
echo '-4' > /sys/power/percent_margin/cam_margin_percent
# cp_volt=0
echo '0' > /sys/power/percent_margin/cp_margin_percent
# disp_volt=-4
echo '-4' > /sys/power/percent_margin/disp_margin_percent
# fsys0_volt=-4
echo '-4' > /sys/power/percent_margin/fsys0_margin_percent
# int_volt=-4
echo '-4' > /sys/power/percent_margin/int_margin_percent
# intcam_volt=-4
echo '-4' > /sys/power/percent_margin/intcam_margin_percent
# iva_volt=-4
echo '-4' > /sys/power/percent_margin/iva_margin_percent
# score_volt=-4
echo '-4' > /sys/power/percent_margin/score_margin_percent

#---------------< LIMIT BACKGROUND APP PROCESS (LABS) >---------------#
# limitprocess_on=0
if [ $(getprop ro.build.version.sdk) -eq 35 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 34 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 33 ]; then service call activity 44 i32 -1; fi

#---------------< FORCE DOZE (LABS) >---------------#
# forcedoze_on=0
dumpsys deviceidle unforce

# ======================================`;window.commandFile=t,window.scriptContent=o;let s=(o,s)=>`sed -i "s|echo ['\\"][^'\\"]*['\\"] > ${o}|echo '${s}' > ${o}|g" ${t}; `,i={toggles:[{id:"forcebattapps_opt",marker:"forceappsbattopt_on",defaultState:!0,blockActive:`# forceappsbattopt_on=1
settings put global forced_app_standby_enabled 1`,blockInactive:`# forceappsbattopt_on=0
settings put global forced_app_standby_enabled 0`,liveCommandActive:"settings put global forced_app_standby_enabled 1",liveCommandInactive:"settings put global forced_app_standby_enabled 0"},{id:"cpu_hotplug",marker:"hotplugset_on",defaultState:!0,paths:[{path:"/sys/power/cpuhotplug/governor/user_mode",active:"0",inactive:"1"},{path:"/sys/power/cpuhotplug/governor/enabled",active:"0",inactive:"1"}],liveCommandActive:"echo '0' > /sys/power/cpuhotplug/governor/user_mode && echo '0' > /sys/power/cpuhotplug/governor/enabled",liveCommandInactive:"echo '1' > /sys/power/cpuhotplug/governor/user_mode && echo '1' > /sys/power/cpuhotplug/governor/enabled"},{id:"power_eff",marker:"powereffiset_on",defaultState:!0,paths:[{path:"/sys/module/workqueue/parameters/power_efficient",active:"Y",inactive:"N"}],liveCommandActive:"echo 'Y' > /sys/module/workqueue/parameters/power_efficient",liveCommandInactive:"echo 'N' > /sys/module/workqueue/parameters/power_efficient"},{id:"thermal_opt",marker:"thermalset_on",defaultState:!0,blockActive:`# thermalset_on=1
system_table_set activity_manager_constants max_cached_processes=0,background_settle_time=0,fgservice_min_shown_time=0,fgservice_min_report_time=0,fgservice_screen_on_before_time=0,fgservice_screen_on_after_time=0,content_provider_retain_time=0,gc_timeout=0,gc_min_interval=0,full_pss_min_interval=0,full_pss_lowered_interval=0,power_check_interval=0,power_check_max_cpu_1=0,power_check_max_cpu_2=0,power_check_max_cpu_3=0,power_check_max_cpu_4=0,service_usage_interaction_time=0,usage_stats_interaction_interval=0,service_restart_duration=0,service_reset_run_duration=0,service_restart_duration_factor=0,service_min_restart_time_between=0,service_max_inactivity=0,service_bg_start_timeout=0,CUR_MAX_CACHED_PROCESSES=0,CUR_MAX_EMPTY_PROCESSES=0,CUR_TRIM_EMPTY_PROCESSES=0,CUR_TRIM_CACHED_PROCESSES=0
chmod 666 /sys/devices/system/cpu/cpu[0-7]/max_cpus; chmod 666 /sys/devices/system/cpu/cpu[0-7]/min_cpus
echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/max_cpus; echo 0 > /sys/devices/system/cpu/cpu4/core_ctl/min_cpus; echo 60 > /sys/devices/system/cpu/cpu4/core_ctl/busy_down_thres
echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/task_thres; echo 80 > /sys/devices/system/cpu/cpu4/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu4/core_ctl/offline_delay_ms
echo 2 > /sys/devices/system/cpu/cpu0/core_ctl/min_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/max_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/task_thres
echo 80 > /sys/devices/system/cpu/cpu0/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu0/core_ctl/offline_delay_ms; echo 60 > /sys/devices/system/cpu/cpu0/core_ctl/busy_down_thres
chmod 444 /sys/devices/system/cpu/cpu[0-7]/max_cpus
pm disable com.google.android.gms/.chimera.GmsIntentOperationService`,blockInactive:`# thermalset_on=0
system_table_unset activity_manager_constants
pm enable com.google.android.gms/.chimera.GmsIntentOperationService`,liveCommandActive:"system_table_set activity_manager_constants max_cached_processes=0,background_settle_time=0,fgservice_min_shown_time=0,fgservice_min_report_time=0,fgservice_screen_on_before_time=0,fgservice_screen_on_after_time=0,content_provider_retain_time=0,gc_timeout=0,gc_min_interval=0,full_pss_min_interval=0,full_pss_lowered_interval=0,power_check_interval=0,power_check_max_cpu_1=0,power_check_max_cpu_2=0,power_check_max_cpu_3=0,power_check_max_cpu_4=0,service_usage_interaction_time=0,usage_stats_interaction_interval=0,service_restart_duration=0,service_reset_run_duration=0,service_restart_duration_factor=0,service_min_restart_time_between=0,service_max_inactivity=0,service_bg_start_timeout=0,CUR_MAX_CACHED_PROCESSES=0,CUR_MAX_EMPTY_PROCESSES=0,CUR_TRIM_EMPTY_PROCESSES=0,CUR_TRIM_CACHED_PROCESSES=0 && chmod 666 /sys/devices/system/cpu/cpu[0-7]/max_cpus && chmod 666 /sys/devices/system/cpu/cpu[0-7]/min_cpus && echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/max_cpus && echo 0 > /sys/devices/system/cpu/cpu4/core_ctl/min_cpus && echo 60 > /sys/devices/system/cpu/cpu4/core_ctl/busy_down_thres && echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/task_thres && echo 80 > /sys/devices/system/cpu/cpu4/core_ctl/busy_up_thres && echo 100 > /sys/devices/system/cpu/cpu4/core_ctl/offline_delay_ms && echo 2 > /sys/devices/system/cpu/cpu0/core_ctl/min_cpus && echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/max_cpus && echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/task_thres && echo 80 > /sys/devices/system/cpu/cpu0/core_ctl/busy_up_thres && echo 100 > /sys/devices/system/cpu/cpu0/core_ctl/offline_delay_ms && echo 60 > /sys/devices/system/cpu/cpu0/core_ctl/busy_down_thres && chmod 444 /sys/devices/system/cpu/cpu[0-7]/max_cpus && pm disable com.google.android.gms/.chimera.GmsIntentOperationService",liveCommandInactive:"system_table_unset activity_manager_constants && pm enable com.google.android.gms/.chimera.GmsIntentOperationService"},{id:"gpuboost_opt",marker:"gpuboost_on",defaultState:!1,paths:[{path:"/sys/devices/platform/17500000.mali/dvfs_governor",active:"3",inactive:"1"}],liveCommandActive:"echo '3' > /sys/devices/platform/17500000.mali/dvfs_governor",liveCommandInactive:"echo '1' > /sys/devices/platform/17500000.mali/dvfs_governor"},{id:"swap_opt",marker:"swapset_on",defaultState:!0,paths:[{path:"/proc/sys/vm/dirty_ratio",active:"10",inactive:"0"},{path:"/proc/sys/vm/dirty_background_ratio",active:"3",inactive:"0"},{path:"/proc/sys/vm/dirty_expire_centisecs",active:"2500",inactive:"200"},{path:"/proc/sys/vm/dirty_writeback_centisecs",active:"1250",inactive:"500"},{path:"/proc/sys/vm/laptop_mode",active:"2",inactive:"0"},{path:"/proc/sys/vm/swappiness",active:"70",inactive:"100"}]},{id:"storage_opt",marker:"storageset_on",defaultState:!0,paths:[{path:"/sys/block/sda/queue/rotational",active:"1",inactive:"0"},{path:"/sys/block/sda/queue/add_random",active:"1",inactive:"0"},{path:"/sys/block/sda/queue/rq_affinity",active:"2",inactive:"1"}]},{id:"batteryprotect_opt",marker:"batteryprotect_on",defaultState:!1,paths:[{path:"/sys/class/power_supply/battery/batt_full_capacity",active:null,inactive:"100"}],dynamicPaths:[{path:"/sys/class/power_supply/battery/batt_full_capacity",dependsOn:"batt_level",transform:t=>t+80}]},{id:"frq_on",marker:"frqset_on",defaultState:!0,paths:[{path:"/sys/devices/system/cpu/cpufreq/policy0/scaling_max_freq",active:null,inactive:"1794000"},{path:"/sys/devices/system/cpu/cpufreq/policy4/scaling_max_freq",active:null,inactive:"2704000"}],dynamicPaths:[{path:"/sys/devices/system/cpu/cpufreq/policy0/scaling_max_freq",dependsOn:"frq_little",transform:t=>1e3*parseInt(t)},{path:"/sys/devices/system/cpu/cpufreq/policy4/scaling_max_freq",dependsOn:"frq_big",transform:t=>1e3*parseInt(t)}]},{id:"volt_on",marker:"voltset_on",defaultState:!0,paths:[{path:"/sys/power/percent_margin/big_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/lit_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/g3d_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/mif_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/aud_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/cam_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/cp_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/disp_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/fsys0_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/int_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/intcam_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/iva_margin_percent",active:null,inactive:"0"},{path:"/sys/power/percent_margin/score_margin_percent",active:null,inactive:"0"}],dynamicPaths:[{path:"/sys/power/percent_margin/big_margin_percent",dependsOn:"big_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/lit_margin_percent",dependsOn:"lit_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/g3d_margin_percent",dependsOn:"g3d_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/mif_margin_percent",dependsOn:"mif_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/aud_margin_percent",dependsOn:"aud_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/cam_margin_percent",dependsOn:"cam_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/cp_margin_percent",dependsOn:"cp_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/disp_margin_percent",dependsOn:"disp_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/fsys0_margin_percent",dependsOn:"fsys0_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/int_margin_percent",dependsOn:"int_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/intcam_margin_percent",dependsOn:"intcam_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/iva_margin_percent",dependsOn:"iva_volt",transform:t=>-Math.round(t)},{path:"/sys/power/percent_margin/score_margin_percent",dependsOn:"score_volt",transform:t=>-Math.round(t)}]},{id:"limitbackground_opt",marker:"limitprocess_on",defaultState:!1,blockActive:`# limitprocess_on=1
if [ $(getprop ro.build.version.sdk) -eq 35 ]; then service call activity 51 i32 4; elif [ $(getprop ro.build.version.sdk) -eq 34 ]; then service call activity 51 i32 4; elif [ $(getprop ro.build.version.sdk) -eq 33 ]; then service call activity 44 i32 4; fi`,blockInactive:`# limitprocess_on=0
if [ $(getprop ro.build.version.sdk) -eq 35 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 34 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 33 ]; then service call activity 44 i32 -1; fi`,liveCommandActive:"if [ $(getprop ro.build.version.sdk) -eq 35 ]; then service call activity 51 i32 4; elif [ $(getprop ro.build.version.sdk) -eq 34 ]; then service call activity 51 i32 4; elif [ $(getprop ro.build.version.sdk) -eq 33 ]; then service call activity 44 i32 4; fi",liveCommandInactive:"if [ $(getprop ro.build.version.sdk) -eq 35 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 34 ]; then service call activity 51 i32 -1; elif [ $(getprop ro.build.version.sdk) -eq 33 ]; then service call activity 44 i32 -1; fi"},{id:"forcedoze_opt",marker:"forcedoze_on",defaultState:!1,blockActive:`# forcedoze_on=1
dumpsys deviceidle force-idle`,blockInactive:`# forcedoze_on=0
dumpsys deviceidle unforce`,liveCommandActive:"dumpsys deviceidle force-idle",liveCommandInactive:"dumpsys deviceidle unforce"}],popups:[{id:"frq_little",path:"/sys/devices/system/cpu/cpufreq/policy0/scaling_max_freq",marker:"lit",defaultValue:"1690 Mhz",options:[],masterToggle:"frq_on",inactiveValue:1794e3,transformToPath:t=>1e3*parseInt(t),transformFromPath:t=>t+" Mhz"},{id:"frq_big",path:"/sys/devices/system/cpu/cpufreq/policy4/scaling_max_freq",marker:"big",defaultValue:"1690 Mhz",options:[],masterToggle:"frq_on",inactiveValue:2704e3,transformToPath:t=>1e3*parseInt(t),transformFromPath:t=>t+" Mhz"}],sliders:[{id:"batt_level",path:"/sys/class/power_supply/battery/batt_full_capacity",marker:"battery_litmit",defaultValue:90,min:0,max:15,step:1,valueToSlider:t=>t-80,sliderToValue:t=>t+80,masterToggle:"batteryprotect_opt",inactiveValue:100,unit:"%"},...["big","lit","g3d","mif","aud","cam","cp","disp","fsys0","int","intcam","iva","score"].map(t=>({id:`${t}_volt`,path:`/sys/power/percent_margin/${t}_margin_percent`,marker:`${t}_volt`,defaultValue:"cp"===t?0:-4,min:0,max:10,step:1,valueToSlider:t=>-t,sliderToValue:t=>-t,masterToggle:"volt_on",inactiveValue:0}))]};function n(o,n){let a="";if(o.marker&&(a+=`sed -i "s|^# ${o.marker}=.*|# ${o.marker}=${+!!n}|" ${t}; `),n?o.blockActive:o.blockInactive){var r;let s,i,c=n?o.blockActive:o.blockInactive;a+=(r=o.marker,s=`${t}.${r}_block.tmp`,i=`${t}.tmp`,`cat > ${s} <<'EOB'
${c}
EOB
awk -v blk='${s}' -v marker='^# ${r}=' 'BEGIN{skip=0;found=0} { if($0 ~ marker){ found=1; while((getline line < blk) > 0) print line; skip=1; next } if(skip){ if($0 ~ /^$/ || $0 ~ /^#-+/){ skip=0; print $0; next } else next } print $0 } END{ if(!found){ while((getline line < blk) > 0) print line } }' ${t} > ${i}; mv ${i} ${t}; rm -f ${s}; `)}if(o.paths)for(let t of o.paths){let r;if(n)if(null!==t.active)r=t.active;else{let s=o.dynamicPaths?.find(o=>o.path===t.path);if(s){let o=document.getElementById(s.dependsOn);if(o){let t;if(null==(t="INPUT"===o.tagName&&"range"===o.type?parseFloat(o.value):o.dataset.selected)){let o=i.sliders.find(t=>t.id===s.dependsOn),n=i.popups.find(t=>t.id===s.dependsOn);o?t=o.defaultValue:n&&(t=n.defaultValue)}r=s.transform(t)}else r=t.inactive}else r=t.active}else r=t.inactive;a+=`echo '${r}' > ${t.path}; ${s(t.path,r)}`}if(n?o.liveCommandActive:o.liveCommandInactive){let t=n?o.liveCommandActive:o.liveCommandInactive;a+=`${t}; `}return a}function a(o){let s=document.getElementById(o.id);if(!s)return;let i=`toggle_${o.id}`,a=localStorage.getItem(i),r=null!==a?"1"===a:!!o.defaultState;s.checked=r,o.marker&&setTimeout(async()=>{try{let n=(await execSafe(`grep -m1 "^# ${o.marker}=" ${t} || echo "# ${o.marker}=${+!!r}"`)).match(RegExp(`^# ${o.marker}=(\\d+)`));if(n){let t="1"===n[1];t!==r&&(localStorage.setItem(i,t?"1":"0"),s.checked=t,s.dispatchEvent(new Event("change",{bubbles:!0})))}}catch{}},0);let c=null;s.addEventListener("change",()=>{let t=s.checked;localStorage.setItem(i,t?"1":"0"),clearTimeout(c),c=setTimeout(()=>{let s=n(o,t);s&&execSafe(s)},249)})}function r(o){let i=document.getElementById(o.id);if(!i)return;i.min=o.min,i.max=o.max,i.step=o.step;let n=`slider_${o.id}`,a=localStorage.getItem(n),r=null!==a?Number(a):o.defaultValue;i.value=o.valueToSlider?o.valueToSlider(r):r,setTimeout(async()=>{try{let s=(await execSafe(`grep -m1 "^# ${o.marker}=" ${t} || echo "# ${o.marker}=${r}"`)).match(RegExp(`^# ${o.marker}=([^%\\n]*)`));if(s){let t=Number(s[1]);t!==r&&(i.value=o.valueToSlider?o.valueToSlider(t):t,localStorage.setItem(n,t))}}catch{}},0);let c=null;i.addEventListener("change",()=>{let a=parseFloat(i.value),r=o.sliderToValue?o.sliderToValue(a):a;localStorage.setItem(n,r),clearTimeout(c),c=setTimeout(()=>{let i=document.getElementById(o.masterToggle),n=!i||i.checked?r:o.inactiveValue,a=`sed -i "s|^# ${o.marker}=.*|# ${o.marker}=${r}${o.unit||""}|" ${t}; `;execSafe(a+=`echo '${n}' > ${o.path}; ${s(o.path,n)}`)},249)})}function c(o){let i=document.getElementById(o.id);if(!i)return;let n=[];try{n=JSON.parse(i.dataset.options||"[]")}catch{n=o.options}o.options=n;let a=`popup_${o.id}`,r=localStorage.getItem(a)||o.defaultValue;i.dataset.selected=r;let c=i.querySelector(".popup-value");c||((c=document.createElement("span")).className="popup-value",i.appendChild(c)),c.textContent=r,setTimeout(async()=>{try{let s=(await execSafe(`grep -m1 "^# ${o.marker}=" ${t} || echo "# ${o.marker}=${parseInt(r)}"`)).match(RegExp(`^# ${o.marker}=(\\d+)`));if(s){let t=s[1],n=o.transformFromPath(Number(t));n!==r&&(i.dataset.selected=n,c.textContent=n,localStorage.setItem(a,n))}}catch{}},0),i.addEventListener("click",n=>{n.stopPropagation(),window.initPopup&&(document.querySelectorAll(".popup-label-active").forEach(t=>t.classList.remove("popup-label-active")),i.classList.add("popup-label-active"),window.initPopup.disableOptionsTemporarily?.(300),window.initPopup.openPopup(i,n=>{i.dataset.selected=n,c.textContent=n,localStorage.setItem(a,n),setTimeout(()=>{let i=document.getElementById(o.masterToggle),a=!i||i.checked?o.transformToPath(n):o.inactiveValue,r=n.split(" ")[0];execSafe(`sed -i "s|^# ${o.marker}=.*|# ${o.marker}=${r}|" ${t}; echo '${a}' > ${o.path}; ${s(o.path,a)}`)},249)},o.options))})}window.applySettings=async function(){let o="";try{o=await execSafe(`cat ${t}`)}catch{o=""}for(let n of i.sliders){let i=document.getElementById(n.id);if(!i)continue;let a=`slider_${n.id}`,r=localStorage.getItem(a);null===r&&(r=n.defaultValue,localStorage.setItem(a,r)),r=Number(r),i.value=n.valueToSlider?n.valueToSlider(r):r;let c=RegExp(`^# ${n.marker}=([^%\\n]*)`,"m"),l=o.match(c);if(l&&Number(l[1])!==r){let o=document.getElementById(n.masterToggle),i=!o||o.checked?r:n.inactiveValue,a=`sed -i "s|^# ${n.marker}=.*|# ${n.marker}=${r}${n.unit||""}|" ${t}; `;a+=`echo '${i}' > ${n.path}; ${s(n.path,i)}`,await execSafe(a)}}for(let n of i.popups){let i=document.getElementById(n.id);if(!i)continue;let a=`popup_${n.id}`,r=localStorage.getItem(a)||n.defaultValue;localStorage.setItem(a,r),i.dataset.selected=r;let c=i.querySelector(".popup-value");c&&(c.textContent=r);let l=RegExp(`^# ${n.marker}=(\\d+)`,"m"),d=o.match(l);if(d){let o=d[1],l=n.transformFromPath(Number(o));if(l!==r){localStorage.setItem(a,l),i.dataset.selected=l,c&&(c.textContent=l);let o=document.getElementById(n.masterToggle),r=!o||o.checked?n.transformToPath(l):n.inactiveValue,d=l.split(" ")[0],u=`sed -i "s|^# ${n.marker}=.*|# ${n.marker}=${d}|" ${t}; `;u+=`echo '${r}' > ${n.path}; ${s(n.path,r)}`,await execSafe(u)}}}for(let t of i.toggles){let s=document.getElementById(t.id);if(!s)continue;let i=`toggle_${t.id}`,a=localStorage.getItem(i);null===a&&(a=t.defaultState?"1":"0",localStorage.setItem(i,a));let r="1"===a;if(t.marker){let s=RegExp(`^# ${t.marker}=(\\d+)`,"m"),i=o.match(s),a=i?"1"===i[1]:null;if(null!==a&&a!==r){let o=n(t,r);await execSafe(o)}}s.checked!==r?(s.checked=r,s.dispatchEvent(new Event("change",{bubbles:!0}))):r&&t.dynamicPaths&&s.dispatchEvent(new Event("change",{bubbles:!0}))}},document.addEventListener("DOMContentLoaded",()=>{execSafe(`if [ ! -f ${t} ]; then cat > ${t} << 'EOF'
${o}
EOF
fi`),i.toggles.forEach(a),i.sliders.forEach(r),i.popups.forEach(c)})}(),document.addEventListener("DOMContentLoaded",()=>{let t={mask:document.querySelector(".oui-dialog-mask"),body:document.body,resetButton:document.querySelector(".close-dialog-text-reset")};window.resetLoadingAnimation=function(t){t&&(t.style.animation="none",t.offsetHeight,t.style.animation="",t.querySelectorAll(".ball").forEach(t=>{t.style.animation="none",t.offsetHeight,t.style.animation=""}))};let o={open(o){let s=document.getElementById(o);if(!s||!t.mask)return;let i=s.querySelector(".oui-loading");i&&resetLoadingAnimation&&resetLoadingAnimation(i),s.classList.add("show"),t.mask.classList.add("show"),t.body.classList.add("no-scroll")},close(){let o=document.querySelector(".oui-dialog.show");return!!o&&!!t.mask&&(o.classList.remove("show"),o.classList.add("hide"),t.mask.classList.remove("show"),t.body.classList.remove("no-scroll"),setTimeout(()=>o.classList.remove("hide"),5),!0)},closeKeepingMask(){let o=document.querySelector(".oui-dialog.show");return!!o&&(o.classList.remove("show"),o.classList.add("hide"),t.mask&&t.mask.classList.add("show"),t.body.classList.add("no-scroll"),setTimeout(()=>o.classList.remove("hide"),5),!0)}};if(t.resetButton){let s=t.resetButton.closest(".reset-dialog-btn");if(!s)return;s.removeEventListener("click",o.close),s.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();let i=document.createElement("div");i.id="temp-blocking-layer",i.style.cssText="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 3000; pointer-events: all;",t.body.appendChild(i),t.body.classList.add("no-scroll"),o.closeKeepingMask()&&setTimeout(()=>{i.remove(),o.open("resetting_app_dialog"),setTimeout(()=>{let t;t=["settings put global forced_app_standby_enabled 1","echo '0' > /sys/power/cpuhotplug/governor/user_mode","echo '0' > /sys/power/cpuhotplug/governor/enabled","echo 'Y' > /sys/module/workqueue/parameters/power_efficient","system_table_set activity_manager_constants max_cached_processes=0,background_settle_time=0,fgservice_min_shown_time=0,fgservice_min_report_time=0,fgservice_screen_on_before_time=0,fgservice_screen_on_after_time=0,content_provider_retain_time=0,gc_timeout=0,gc_min_interval=0,full_pss_min_interval=0,full_pss_lowered_interval=0,power_check_interval=0,power_check_max_cpu_1=0,power_check_max_cpu_2=0,power_check_max_cpu_3=0,power_check_max_cpu_4=0,service_usage_interaction_time=0,usage_stats_interaction_interval=0,service_restart_duration=0,service_reset_run_duration=0,service_restart_duration_factor=0,service_min_restart_time_between=0,service_max_inactivity=0,service_bg_start_timeout=0,CUR_MAX_CACHED_PROCESSES=0,CUR_MAX_EMPTY_PROCESSES=0,CUR_TRIM_EMPTY_PROCESSES=0,CUR_TRIM_CACHED_PROCESSES=0","chmod 666 /sys/devices/system/cpu/cpu[0-7]/max_cpus; chmod 666 /sys/devices/system/cpu/cpu[0-7]/min_cpus","echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/max_cpus; echo 0 > /sys/devices/system/cpu/cpu4/core_ctl/min_cpus; echo 60 > /sys/devices/system/cpu/cpu4/core_ctl/busy_down_thres","echo 4 > /sys/devices/system/cpu/cpu4/core_ctl/task_thres; echo 80 > /sys/devices/system/cpu/cpu4/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu4/core_ctl/offline_delay_ms","echo 2 > /sys/devices/system/cpu/cpu0/core_ctl/min_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/max_cpus; echo 4 > /sys/devices/system/cpu/cpu0/core_ctl/task_thres","echo 80 > /sys/devices/system/cpu/cpu0/core_ctl/busy_up_thres; echo 100 > /sys/devices/system/cpu/cpu0/core_ctl/offline_delay_ms; echo 60 > /sys/devices/system/cpu/cpu0/core_ctl/busy_down_thres","chmod 444 /sys/devices/system/cpu/cpu[0-7]/max_cpus","pm disable com.google.android.gms/.chimera.GmsIntentOperationService","echo '1' > /sys/devices/platform/17500000.mali/dvfs_governor","echo '10' > /proc/sys/vm/dirty_ratio","echo '3' > /proc/sys/vm/dirty_background_ratio","echo '2500' > /proc/sys/vm/dirty_expire_centisecs","echo '1250' > /proc/sys/vm/dirty_writeback_centisecs","echo '2' > /proc/sys/vm/laptop_mode","echo '70' > /proc/sys/vm/swappiness","echo '1' > /sys/block/sda/queue/rotational","echo '1' > /sys/block/sda/queue/add_random","echo '2' > /sys/block/sda/queue/rq_affinity","echo '100' > /sys/class/power_supply/battery/batt_full_capacity","echo '1690000' > /sys/devices/system/cpu/cpufreq/policy0/scaling_max_freq","echo '1690000' > /sys/devices/system/cpu/cpufreq/policy4/scaling_max_freq","echo '-4' > /sys/power/percent_margin/big_margin_percent","echo '-4' > /sys/power/percent_margin/lit_margin_percent","echo '-4' > /sys/power/percent_margin/g3d_margin_percent","echo '-4' > /sys/power/percent_margin/mif_margin_percent","echo '-4' > /sys/power/percent_margin/aud_margin_percent","echo '-4' > /sys/power/percent_margin/cam_margin_percent","echo '0' > /sys/power/percent_margin/cp_margin_percent","echo '-4' > /sys/power/percent_margin/disp_margin_percent","echo '-4' > /sys/power/percent_margin/fsys0_margin_percent","echo '-4' > /sys/power/percent_margin/int_margin_percent","echo '-4' > /sys/power/percent_margin/intcam_margin_percent","echo '-4' > /sys/power/percent_margin/iva_margin_percent","echo '-4' > /sys/power/percent_margin/score_margin_percent","if [ $API -eq 35 ]; then service call activity 51 i32 -1; elif [ $API -eq 34 ]; then service call activity 51 i32 -1; elif [ $API -eq 33 ]; then service call activity 44 i32 -1; fi","dumpsys deviceidle unforce"],localStorage.clear(),setTimeout(()=>{t.forEach(t=>execSafe(t));let o=scriptContent.replace("# changelog=1","# changelog=0");execSafe(`cat > ${commandFile} << 'EOF'
${o}
EOF`)},5),setTimeout(()=>execSafe("input keyevent 4"),4e3)},5)},700)})}});let S=!0,k={mask:document.querySelector(".oui-loading-mask"),dialog:document.querySelector(".oui-dialog"),loader:document.querySelector(".oui-loading"),label:null,body:document.body,docElement:document.documentElement};async function T(){k.mask.classList.remove("active"),k.dialog.style.cssText+="opacity: 0; pointer-events: none; transform: translateX(-50%) translateY(20px);",k.loader.classList.remove("active"),k.body.classList.remove("no-scroll");let t=async o=>{o.target!==k.mask||k.mask.classList.contains("active")||(await sleep(5),S=!1,k.mask.removeEventListener("transitionend",t),k.body.classList.remove("app-blocked-body"),k.docElement.classList.remove("app-blocked"))};k.mask.addEventListener("transitionend",t,{passive:!0})}async function q(){try{let t=await execSafe("dumpsys battery 2>/dev/null | grep mSavedBatteryAsoc | head -1"),o=await execSafe("dumpsys battery 2>/dev/null | grep mSavedBatteryUsage | head -1"),s=null,i=null;if(t){let o=t.match(/(\d+)/);o&&(s=o[1])}if(o){let t=o.match(/(\d+)/);if(t){let o=t[1],s=o;if(o.length>=3){let t=o.slice(0,-1);s=t.slice(0,-1)+"."+t.slice(-1)}i=s}}let n=document.getElementById("battery_health");s&&i?n.textContent=`${s}% / ${i} Cycles`:n.textContent="Unknown"}catch{document.getElementById("battery_health").textContent="Unknown"}}async function x(){try{let t=await execSafe("pm list packages | grep com.guru.batteryoptimizer");return t&&t.toString().trim().includes("com.guru.batteryoptimizer")}catch{return!1}}async function I(){try{let t=await execSafe(`[ -f ${commandFile} ] && echo "exists" || echo "not_found"`);if("exists"!==t.trim())return;let o=await execSafe(`grep -F "# changelog=" ${commandFile} | cut -d'=' -f2`);"1"===o.trim()&&(await execSafe(`sed -i "s|# changelog=.*|# changelog=0|" ${commandFile}`),await sleep(500),openDialog(document.getElementById("whatsnew_dialog"),{mask:!0,maskType:"default"}))}catch{}}!async function(){let t,o=await x();if((t=document.querySelector(".closemodule-dialog-btn"))&&t.addEventListener("click",()=>{try{execSafe("input keyevent 4")}catch{}}),await sleep(200),q(),await sleep(1500),new Promise(t=>{splashScreen.classList.remove("show"),setTimeout(t,200)}),k.body.classList.add("app-blocked-body"),k.docElement.classList.add("app-blocked"),await sleep(500),k.label||(k.label=document.querySelector(".oui-dialog-description")),k.label&&(k.label.innerHTML="Checking Settings..."),k.dialog.style.cssText+="opacity: 1; pointer-events: auto; transform: translateX(-50%) translateY(0);",k.loader.classList.add("active"),k.body.classList.add("no-scroll"),await sleep(500),o){execSafe("rm -f /data/adb/modules/battery-guru-optimizer-9810/boot-completed.sh"),k.dialog.style.cssText+="opacity: 0; pointer-events: none; transform: translateX(-50%) translateY(20px);",k.loader.classList.remove("active"),k.body.classList.remove("no-scroll"),S=!1,await sleep(300),openDialog(document.getElementById("moduledisabled_dialog"),{mask:!1});return}await applySettings(),await sleep(700),S&&(await T(),I())}();